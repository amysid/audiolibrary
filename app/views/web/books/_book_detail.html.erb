<% if false %>
<h4 class="modal-title text-center mb-3" id="H1"><%= t("book_details") %></h4>
<button class="close close-L" type="button" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
<div class="row">
  <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t('book_title')%></label>
  <div class="col-md-7 col-form-label text-black font-17">
    <%= @book.title %>
  </div>                           
</div>
<div class="row">
  <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t('author_name')%></label>
  <div class="col-md-7 col-form-label text-black font-17">
    <%= @book.author_name %>
  </div>                           
</div>
<div class="row">
  <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t('category')%></label>
  <div class="col-md-7 col-form-label text-black font-17">
    <%= @book.categories.pluck(:name).join(", ") %>
  </div>                           
</div>
<div class="row">
  <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t('duration_of_the_book_in_minutes')%></label>
  <div class="col-md-7 col-form-label text-black font-17">
    <%= @book.book_duration %>
  </div>                           
</div>
<div class="row">
  <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t('listening')%></label>
  <div class="col-md-7 col-form-label text-black font-17">
    <%= @book.listen_count %>
  </div>                           
</div>
<div class="row">
  <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t('status')%></label>
  <div class="col-md-7 col-form-label text-black font-17">
    <%= @book.status %>
  </div>                           
</div>
<h4 class="mt-3 mb-3"><%= t('audio_book_files') %></h4>

<div class="row">
  <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t('book_cover')%></label>
  <% @book.book_files.each do |bf| %>
    <div class="col-md-7 col-form-label text-black font-17">
      <img src="<%= rails_blob_path(bf.book_cover_file , only_path: true) if bf.book_cover_file.present? %>" class="book-cover-img">
    </div> 
  <% end %>                          
</div>

<div class="row">
  <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t('audio_file')%></label>
  <% @book.book_files.each do |bf| %>
    <div class="col-md-7 col-form-label text-black font-17">
      <audio  controls="controls" src="<%= rails_blob_path(bf.audio, only_path: true) if bf.audio.present? %>"></audio>
    </div> 
  <% end %>                          
</div>

<div class="row">
  <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t('short_audio')%></label>
  <% @book.book_files.each do |bf| %>
    <div class="col-md-7 col-form-label text-black font-17">
      <audio  controls="controls" src="<%= rails_blob_path(bf.short_audio_file, only_path: true) if bf.short_audio_file.present? %>"></audio>
    </div> 
  <% end %>                          
</div>

<div class="qr-code">
  <div class="row">
    <label for="example-text-input" class="col-md-4 col-form-label text-center"><%= t("qr_code") %></label>
    <div class="col-md-7 col-form-label text-black font-17">
      <%= @qr_code.as_svg( offset: 0, color: "000", shape_rendering: 'crispEdges', module_size: 6, standalone: true ).html_safe %>
    </div>
  </div>
</div>

<center><%= link_to t("back"), web_booth_books_path(booth_id: @booth.number), class: "btn btn-block btn-danger btn-login mt-4", remote: true %></center>


<style type="text/css">
  .book-cover-img{
    width: 40%;
    height: 40%;
  }
  .font-17{font-size: 17px}
  .text-black{color:#000;}
</style>
<% end %>


<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
</head>
<body>
  <div class="main-wrapper main">
    <div class="book-detail">
      <div class="container">
        <div class="row">
          <div class="col-md-6 pr-0">
            <div class="image-grid-container common-clearfix">
              <div class="image-grid-col50">
                <div class="image-grid-imageContainer">
                  <% img_url = @book.book_files.first.book_cover_file.url rescue nil  %>
                  <div class="image-grid-image" style="background-image: url(<%= img_url %>);"></div>
                  <div class="image-grid-skeletonLoader"></div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6 pl-0">
            <div class="detail-info pr-30 pl-30">
              <h2 class="title-detail"><%= @book.title %></h2>
              <div class="short-desc mb-30">
                <h4><%= t('overview') %></h4>
                <p class="font-lg mt-4">
                  <%= @book.body %>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="book-detail-2">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="book-detail-2-mini row">
              <div class="col-md-4">
                <div class="time text-center">
                  <p><%= t('time') %></p>
                  <h5><%= @book.book_duration %> minutes</h5>
                </div>
              </div>

              <div class="col-md-4">
                <div class="author-main text-center">
                  <p><%= t('author') %></p>
                  <h5><%= @book.author_name %></h5>
                </div>
              </div>

              <div class="col-md-4">
                <div class="category text-center">
                  <p><%= t('category') %></p>
                  <h5><%= @book.categories.pluck(:name).join(", ") %></h5>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="book-detail-2-mini row dark-bg">
              <div class="book-scan-cd">
                <div class="left">
                  <h3 class="text-white">Get the full version of this audiobook now in 2 easy steps and enjoy!</h3>
                  <ul class="css-f4kgqr">
                    <li><i class="fa fa-qrcode" aria-hidden="true"></i>Scan the QR code with your mobile phone camera</li>
                    <li><span><i class="fa fa-play" aria-hidden="true"></i></span>Open the link in your mobile browser and enjoy</li>
                  </ul>
                </div>
                <div class="right qr-code">
                  <div class="bg-white qr-bgiio">
                    <div class="qr-image-grid-imageContainer">
                      <%#= qr_url = @qr_code.as_svg( offset: 0, color: "000", shape_rendering: 'crispEdges', module_size: 4, standalone: true ).html_safe %>
                      <!-- <img src="" /> -->
                      <%= image_tag "data:image/png;base64,#{Base64.encode64(@qr_png.to_s).gsub("\n", "")}" %>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <footer class="bg-audioplayer">
      <div class="footer-top">
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <div class="book-player">
    <div class="player">
      <div class="info">
        <h1><%= t('play_book_preview') %></h1>

        <div class="button-items">
          <% sort_audio_url = @book.book_files.first.short_audio_file.url %>
          <audio id="music" preload="auto" loop="false">
            <source src="<%= sort_audio_url %>">
           <!--  <source src="https://dl.dropbox.com/s/75jpngrgnavyu7f/The-Noisy-Freaks.ogg?dl=1" type="audio/ogg"> -->
          </audio>
          <div id="slider">
            <div id="elapsed"></div>
          </div>
          <p id="timer">0:00</p>
          <div class="controls">
            <span class="expend">
              <svg class="step-backward" viewBox="0 0 25 25" xml:space="preserve">
                <g>
                  <polygon points="4.9,4.3 9,4.3 9,11.6 21.4,4.3 21.4,20.7 9,13.4 9,20.7 4.9,20.7" />
                </g>
              </svg></span>

            <svg id="play" viewBox="0 0 25 25" xml:space="preserve">
              <defs>
                <rect x="-49.5" y="-132.9" width="446.4" height="366.4" />
              </defs>
              <g>
                <circle fill="none" cx="12.5" cy="12.5" r="10.8" />
                <path fill-rule="evenodd" clip-rule="evenodd" d="M8.7,6.9V18c0,0,0.2,1.4,1.8,0l8.1-4.8c0,0,1.2-1.1-1-2L9.8,6.5 C9.8,6.5,9.1,6,8.7,6.9z" />
              </g>
            </svg>


            <svg id="pause" viewBox="0 0 25 25" xml:space="preserve">
              <g>
                <rect x="6" y="4.6" width="3.8" height="15.7" />
                <rect x="14" y="4.6" width="3.9" height="15.7" />
              </g>
            </svg>

            <span class="expend">
              <svg class="step-foreward" viewBox="0 0 25 25" xml:space="preserve">
                <g>
                  <polygon points="20.7,4.3 16.6,4.3 16.6,11.6 4.3,4.3 4.3,20.7 16.7,13.4 16.6,20.7 20.7,20.7" />
                </g>
              </svg></span>
          </div>
        </div>
      </div>
    </div>
      </div>
            </div>
          </div>
        </div>
        
      </div>
      <div class="footer-bottom">
      <div class="container">
        <div class="row">
          <div class="col-md-3 text-left">
            <%= link_to  web_booth_books_path(booth_id: @booth.number), class: "btn btn-light-grey btn-footer", remote: true do%>
              <i class="fas fa-arrow-left"></i>
            <% end %>
          </div>
          <div class="col-md-9 text-right">
            <a href="#" class="btn btn-light-grey btn-footer"><i class="fa fa-wheelchair" aria-hidden="true"></i></a>
            <a href="#" class="btn btn-light-grey btn-footer"><i class="fa fa-baby" aria-hidden="true"></i></a>
            <% lang = params[:locale] == "ar" ? "English" : "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© " %>
            <% locale = params[:locale] == "ar" ? "en" : "ar" %>
            <%= link_to "#{lang}", web_booth_book_path(booth_id: @booth.number, id: book.id, locale: locale), remote: true, class: "btn btn-light-grey btn-footer"  %>
            </div>
        </div>
      </div>
        </div>
    </footer>
  </div>
  <script id="rendered-js">
    var music = document.getElementById("music");
    var playButton = document.getElementById("play");
    var pauseButton = document.getElementById("pause");
    var playhead = document.getElementById("elapsed");
    var timeline = document.getElementById("slider");
    var timer = document.getElementById("timer");
    var duration;
    pauseButton.style.visibility = "hidden";

    var timelineWidth = timeline.offsetWidth - playhead.offsetWidth;
    music.addEventListener("timeupdate", timeUpdate, false);

    function timeUpdate() {
      var playPercent = timelineWidth * (music.currentTime / duration);
      playhead.style.width = playPercent + "px";

      var total_minutes = Math.floor(music.duration / 60);
      var total_seconds = Math.floor(music.duration % 60);

      var minutes = Math.floor(music.currentTime / 60);
      var seconds = Math.floor(music.currentTime % 60);
      if (seconds < 10) {
        seconds = '0' + String(seconds);
      }
      timer.innerHTML = minutes + ':' + seconds + "/" + total_minutes + ":" + total_seconds;
    }

    playButton.onclick = function () {
      music.play();
      playButton.style.visibility = "hidden";
      pause.style.visibility = "visible";
    };

    pauseButton.onclick = function () {
      music.pause();
      playButton.style.visibility = "visible";
      pause.style.visibility = "hidden";
    };

    music.addEventListener("canplaythrough", function () {
      duration = music.duration;
    }, false);
    //# sourceURL=pen.js
  </script>
</body>
</html>